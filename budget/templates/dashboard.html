{% extends "template.html" %}

{% block title %}Dashboard{% endblock %}
{% block content %}
            <h1 class="h2">Dashboard</h1>
{% if user.is_authenticated %}
    <p>Welcome, {{ user.first_name }}. Thanks for logging in.</p>
    <ul>
      {% for account in printaccounts %}
  <li>{{ account.name }}</li>
        {% endfor %}
</ul>

{% else %}
    <p>Welcome, new user. Please log in.</p>
{% endif %}

            <h1 class="h2">Dashboard</h1>
            <p>Last Update {{todaydate}}</p>
            <div class="row my-4">
                <div class="col-12 col-md-6 col-lg-3 mb-4 mb-lg-0">
                    <div class="card">
                        <h5 class="card-header">Yesterday</h5>
                        <div class="card-body">
                            <h5 class="card-title">Spent: ${{dayspent}}</h5>
                            <p class="card-text">Budget: ${{daybudget}}</p>
                            <p class="card-text text-success">Left to Spend: ${{dayleftover}}</p>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-4 mb-lg-0 col-lg-3">
                    <div class="card">
                        <h5 class="card-header">7 Days</h5>
                        <div class="card-body">
                            <h5 {% if daypercentreadable > 0 %} class="card-title {% elif daypercentreadable > 0 %}  text-success {% endif %}">Spent: ${{sevenspent}}</h5>
                            <p class="card-text">Budget: ${{sevenbudget}}</p>
                            <p class="card-text text-success">Left to Spend: ${{sevenleftover}}</p>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-4 mb-lg-0 col-lg-3">
                    <div class="card">
                        <h5 class="card-header">30 Days</h5>
                        <div class="card-body">
                            <h5 {% if daypercentreadable > 0 %} class="card-title {% elif daypercentreadable > 0 %}  text-success {% endif %}">Spent: ${{thirtyspent}}</h5>
                            <p class="card-text">Budget: ${{thirtybudget}}</p>
                            <p class="card-text text-success">Left to Spend: ${{thirtyleftover}}</p>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-4 mb-lg-0 col-lg-3">
                    <div class="card">
                        <h5 class="card-header">60 Days</h5>
                        <div class="card-body">
                            <h5 {% if daypercentreadable > 0 %} class="card-title {% elif daypercentreadable > 0 %}  text-success {% endif %}">Spent: ${{sixtyspent}}</h5>
                            <p class="card-text">Budget: ${{sixtybudget}}</p>
                            <p class="card-text text-success">Left to Spend: ${{sixtyleftover}}</p>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-4 mb-lg-0 col-lg-3">
                    <div class="card">
                        <h5 class="card-header">90 Days</h5>
                        <div class="card-body">
                            <h5 {% if daypercentreadable > 0 %} class="card-title {% elif daypercentreadable > 0 %}  text-success {% endif %}">Spent: ${{ninetyspent}}</h5>
                            <p class="card-text">Budget: ${{ninetybudget}}</p>
                            <p class="card-text text-success">Left to Spend: ${{ninetyleftover}}</p>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 mb-4 mb-lg-0 col-lg-3">
                    <div class="card">
                        <h5 class="card-header">180 Days</h5>
                        <div class="card-body">
                            <h5 {% if daypercentreadable > 0 %} class="card-title {% elif daypercentreadable > 0 %}  text-success {% endif %}">Spent: ${{oneeightspent}}</h5>
                            <p class="card-text">Budget: ${{oneeightbudget}}</p>
                            <p class="card-text text-success">Left to Spend: ${{oneeightleftover}}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12 col-xl-8 mb-4 mb-lg-0">
                    <div class="card">
                        <h5 class="card-header">Latest transactions</h5>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th scope="col">Order</th>
                                        <th scope="col">Product</th>
                                        <th scope="col">Customer</th>
                                        <th scope="col">Total</th>
                                        <th scope="col">Date</th>
                                        <th scope="col"></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <th scope="row">17371705</th>
                                        <td>Volt Premium Bootstrap 5 Dashboard</td>
                                        <td>johndoe@gmail.com</td>
                                        <td>€61.11</td>
                                        <td>Aug 31 2020</td>
                                        <td><a href="#" class="btn btn-sm btn-primary">View</a></td>
                                    </tr>
                                    <tr>
                                        <th scope="row">17370540</th>
                                        <td>Pixel Pro Premium Bootstrap UI Kit</td>
                                        <td>jacob.monroe@company.com</td>
                                        <td>$153.11</td>
                                        <td>Aug 28 2020</td>
                                        <td><a href="#" class="btn btn-sm btn-primary">View</a></td>
                                    </tr>
                                    <tr>
                                        <th scope="row">17371705</th>
                                        <td>Volt Premium Bootstrap 5 Dashboard</td>
                                        <td>johndoe@gmail.com</td>
                                        <td>€61.11</td>
                                        <td>Aug 31 2020</td>
                                        <td><a href="#" class="btn btn-sm btn-primary">View</a></td>
                                    </tr>
                                    <tr>
                                        <th scope="row">17370540</th>
                                        <td>Pixel Pro Premium Bootstrap UI Kit</td>
                                        <td>jacob.monroe@company.com</td>
                                        <td>$153.11</td>
                                        <td>Aug 28 2020</td>
                                        <td><a href="#" class="btn btn-sm btn-primary">View</a></td>
                                    </tr>
                                    <tr>
                                        <th scope="row">17371705</th>
                                        <td>Volt Premium Bootstrap 5 Dashboard</td>
                                        <td>johndoe@gmail.com</td>
                                        <td>€61.11</td>
                                        <td>Aug 31 2020</td>
                                        <td><a href="#" class="btn btn-sm btn-primary">View</a></td>
                                    </tr>
                                    <tr>
                                        <th scope="row">17370540</th>
                                        <td>Pixel Pro Premium Bootstrap UI Kit</td>
                                        <td>jacob.monroe@company.com</td>
                                        <td>$153.11</td>
                                        <td>Aug 28 2020</td>
                                        <td><a href="#" class="btn btn-sm btn-primary">View</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <a href="#" class="btn btn-block btn-light">View all</a>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-xl-4">
                    <div class="card">
                        <h5 class="card-header">Traffic last 6 months</h5>
                        <div class="card-body">
                            <div id="traffic-chart"></div>
                        </div>
                    </div>
                </div>
            </div>

{% endblock %}
{% block script %}
<script src="https://cdn.plaid.com/link/v2/stable/link-initialize.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    -->

<script>
var linkHandler = Plaid.create({
  env: 'sandbox',
  clientName: 'Gene Test',
  key: '3255281e09e4d7725cdf8da1c25c8b',
  product: ['transactions'],
  selectAccount: true,
  onSuccess: function(public_token, metadata) {
    // Send the public_token and account ID to your app server.
    var $form = $('<form>', {
      'action': '/',
      'method': 'POST'
    }).append($('<input>', {
      'name': 'public_token',
      'value': public_token,
      'type': 'hidden'
    })).append($('<input>', {
      'name': 'metadata',
      'value': JSON.stringify(metadata),
      'type': 'hidden'
    })).append($('{% csrf_token %}'));
    $(document.body).append($form);
    $form.submit();
  },
});

// Trigger the Link UI
$("#linkButton").click(function() {linkHandler.open();
});

</script>
{% endblock %}